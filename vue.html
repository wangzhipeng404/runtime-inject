<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>react App</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/vant@2.12/lib/index.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <!-- <script src="./lib/babel.min.js"></script> -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/babel-plugin-transform-vue-jsx@4.0.1/dist/babel-plugin-transform-vue-jsx.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vant@2.12/lib/vant.min.js"></script>
  </head>
  <body>
    <div id="app">
    </div>
    <script type="text/babel">
      Vue.use(vant)
      
      Babel.registerPlugin('transform-vue-jsx', window['babel-plugin-transform-vue-jsx'])
      console.log(Babel)
      const app = new Vue({
        el: '#app',
        data: {
          code: `{ nanme: 'comp', data () { return { msg: 123 }}, render () { return <div/> }}`
        },
        computed: {
          component () {
            let temp = {}
            try {
              const code = Babel.transform(`var obj = ${this.code}`, { presets: ['es2015'], plugins: ['transform-vue-jsx'] }).code
              temp = new Function (`${code.replace('"use strict";\n', '')} return obj; `)()
            } catch (e) {
              temp = {
                data () {
                  return {
                    msg: e
                  }
                },
                render (h) {
                  return h('div', {
                    style: {
                      color: 'red'
                    }
                  },
                  JSON.stringify(e, null, 2))
                }
              }
            }
            return temp
          }
        },
        mounted () {
        },
        render (h) {
          return h(this.component)
        }
      })
    </script>
  </body>
</html>
